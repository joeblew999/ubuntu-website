# SEO & Analytics Tasks
#
# Google Search Console, Cloudflare Web Analytics, and
# analytics reporting via cmd/analytics.
#
# Usage:
#   task seo:open:search-console  - Open Google Search Console
#   task seo:open:cf-analytics    - Open Cloudflare Analytics
#   task analytics:report         - Run analytics report

version: '3'

tasks:
  # ===========================================================================
  # Dashboard URLs
  # ===========================================================================

  open:search-console:
    desc: Open Google Search Console
    cmds:
      - open "https://search.google.com/search-console"

  open:cf-analytics:
    desc: Open Cloudflare Web Analytics
    cmds:
      - open "https://dash.cloudflare.com/{{.CF_ACCOUNT_ID}}/web-analytics/overview?siteTag~in={{.CF_WEB_ANALYTICS_SITE_TAG}}"

  setup:
    desc: Open all SEO setup pages (Search Console + Cloudflare Analytics)
    cmds:
      - echo "Opening Google Search Console..."
      - open "https://search.google.com/search-console"
      - echo "Opening Cloudflare Web Analytics..."
      - open "https://dash.cloudflare.com/{{.CF_ACCOUNT_ID}}/web-analytics/overview?siteTag~in={{.CF_WEB_ANALYTICS_SITE_TAG}}"
      - echo ""
      - echo "Setup steps:"
      - echo "1. Google Search Console - Add property, Domain, ubuntusoftware.net"
      - echo "2. Copy verification TXT record to Cloudflare DNS"
      - echo "3. Cloudflare Analytics - Enable Web Analytics (one click)"

  # ===========================================================================
  # Analytics Reports (cmd/analytics)
  # ===========================================================================

  report:
    desc: Check analytics and report changes (>20% threshold)
    cmds:
      - go run ./cmd/analytics/

  report:verbose:
    desc: Check analytics with verbose output
    cmds:
      - go run ./cmd/analytics/ -v

  report:webhook:
    desc: Post analytics changes to webhook (set ANALYTICS_WEBHOOK_URL)
    cmds:
      - go run ./cmd/analytics/ -webhook "$ANALYTICS_WEBHOOK_URL"
