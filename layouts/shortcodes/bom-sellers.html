{{/* BOM Sellers Table - renders CSV data as interactive table with purchase links and images */}}
{{ $file := .Get 0 | default "data/x500_fleet_sellers.csv" }}
{{ with resources.Get $file }}
  {{ $csv := . | transform.Unmarshal }}
  <div class="overflow-x-auto">
    <table class="w-full text-left border-collapse">
      <thead>
        <tr class="bg-gray-100 dark:bg-gray-800">
          <th class="p-3 border-b font-semibold w-16"></th>
          <th class="p-3 border-b font-semibold">Category</th>
          <th class="p-3 border-b font-semibold">Component</th>
          <th class="p-3 border-b font-semibold">SKU</th>
          <th class="p-3 border-b font-semibold">Seller 1</th>
          <th class="p-3 border-b font-semibold">Seller 2</th>
          <th class="p-3 border-b font-semibold">Seller 3</th>
        </tr>
      </thead>
      <tbody>
        {{ range $i, $row := $csv }}
          {{ if gt $i 0 }}
            <tr class="border-b hover:bg-gray-50 dark:hover:bg-gray-700">
              {{ $category := index $row 0 }}
              {{ $component := index $row 1 }}
              {{ $sku := index $row 2 }}
              {{ $image := index $row 3 }}
              {{ $seller1 := index $row 4 }}
              {{ $seller1URL := index $row 5 }}
              {{ $seller2 := index $row 6 }}
              {{ $seller2URL := index $row 7 }}
              {{ $seller3 := index $row 8 }}
              {{ $seller3URL := index $row 9 }}

              <td class="p-2">
                {{ if $image }}
                  {{ $imgPath := printf "images/bom/%s" $image }}
                  {{ with resources.Get $imgPath }}
                    <img src="{{ .RelPermalink }}" alt="{{ $component }}" class="w-12 h-12 object-contain rounded" loading="lazy">
                  {{ else }}
                    <div class="w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded flex items-center justify-center text-xs text-gray-400">—</div>
                  {{ end }}
                {{ else }}
                  <div class="w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded flex items-center justify-center text-xs text-gray-400">—</div>
                {{ end }}
              </td>
              <td class="p-3"><strong>{{ $category }}</strong></td>
              <td class="p-3">{{ $component }}</td>
              <td class="p-3"><code>{{ $sku }}</code></td>
              <td class="p-3">
                {{ if $seller1URL }}
                  <a href="{{ $seller1URL }}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">{{ $seller1 }}</a>
                {{ else if $seller1 }}
                  {{ $seller1 }}
                {{ end }}
              </td>
              <td class="p-3">
                {{ if $seller2URL }}
                  <a href="{{ $seller2URL }}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">{{ $seller2 }}</a>
                {{ else if $seller2 }}
                  {{ $seller2 }}
                {{ end }}
              </td>
              <td class="p-3">
                {{ if $seller3URL }}
                  <a href="{{ $seller3URL }}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">{{ $seller3 }}</a>
                {{ else if $seller3 }}
                  {{ $seller3 }}
                {{ end }}
              </td>
            </tr>
          {{ end }}
        {{ end }}
      </tbody>
    </table>
  </div>
{{ else }}
  <p class="text-red-500">Error: Could not load {{ $file }}</p>
{{ end }}
